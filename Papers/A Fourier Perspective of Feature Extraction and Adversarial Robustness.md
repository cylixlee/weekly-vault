# 特征提取与对抗鲁棒性的傅里叶视角解释

<small style="color: gray; font-family: 'IBM Plex Sans SC Medium'">2025/01/20 · 周论文阅读 · 李政翱</small>

> **来源**
> 
> 此论文收录于 IJCAI 2024，原文为[A Fourier Perspective of Feature Extraction and Adversarial Robustness](https://www.ijcai.org/proceedings/2024/190).

对抗鲁棒性和可解释性是计算机视觉领域的长期挑战，深度神经网络（DNNs）容易受到对抗扰动的影响，这些扰动对人类来说是难以理解和察觉的。然而，网络的不透明性阻碍了对抗鲁棒性的理论研究。作为人类可理解的方法，频率视角被用来研究神经网络和对抗样本的特性。本文提出了基于投影梯度下降（PGD）的攻击方法 $\mathcal F$-PGD，用于攻击特定频率带。实验结果表明：

1. 与神经网络的低频偏置特性相反，同一类神经网络的**有效特征分布在所有频带上**。
2. 同时，当神经网络对不同的频率特征做出协调决策时，**高频特征往往占主导地位**。
3. 此外，攻击实验表明，**低频特征对不同频率的攻击具有更强的鲁棒性**，但对高频的干扰使网络无法做出正确的决策。

这些特性表明，神经网络的决策过程倾向于使用尽可能少的低频特征，而不能整合不同频率的特征。

## 相关工作

### 鲁棒性

鲁棒性是计算机视觉的长期挑战。数据增强可提升网络在多方面的鲁棒性，但无法防御对抗样本。对抗训练是防御对抗攻击的有效方法。对抗攻击算法如FGSM和PGD被提出以研究模型的脆弱性。

### 频率视角

根据卷积定理，卷积神经网络（CNNs）天然具备分离不同频率信息的能力。实验表明，标准CNN依赖于局部纹理而非物体形状编码的长距离依赖进行预测。一些工作发现低频先被学习，然后是高频。频率视角也被用于分析对抗样本，近期工作表明对抗扰动既不在高频也不在低频成分，而是数据集依赖的。
![[Fourier Images.png]]
<div style="page-break-after: always"></div>


## 基础知识

考虑一个标准分类任务，目标是找到最小化风险的模型参数。在信息瓶颈（Information Barrier, IB）框架下，神经网络提取输入随机变量 $X$ 关于输出随机变量 $Y$ 的相关信息，即互信息 $I(X;Y)$ 。实际中，网络只能保证提取与输出 $Y$ 相关的统计量 $T$ ，而非图像中的分类对象 $OY$​。

### 基于傅里叶的 PGD 攻击

为评估对抗攻击对不同频率的影响，使用快速傅里叶变换（FFT）约束对抗扰动的频率。算法基于PGD，通过掩码操作去除扰动的特定频段成分，然后通过逆 FFT 重构梯度。提出 $\mathcal F$-PGD 和 $\mathcal F$-PGD-L 两种方法，后者在低频下更显著。$\mathcal F$-PGD的攻击过程如下：
$$
\delta_t=\nabla_{x_t}L(x_t,y;\theta)
$$
$$
\delta_t^f=F^{-1}(F(\delta_t)\odot M)
$$
$$
x_{t+1}=\mathrm{clip}_{x,\epsilon}(x_t+\alpha \cdot \mathrm{sign}(\delta_t^f))
$$

其中，$F$ 和 $F^{-1}$ 分别表示前向快速傅里叶变换和其对应的逆变换，$M\in\{0,1\}^{d\times d}$ 是掩码矩阵，$\odot$ 表示逐元素乘积，$\alpha$ 是步长，$\epsilon$ 是扰动的范数约束。

## 特征提取的频率特性

为分析特征提取的频率特性，评估网络在不同频段的性能，并分析整个数据集及每个类别的频率特性。使用理想低通滤波器（LPF）、高通滤波器（HPF）和带通滤波器（BPF）去除指定频率信息，实验在 ImageNet 上进行。

### 特征分布

测试不同频段（带宽为15）的特征分布，发现所有频段都富含有效特征，各频段分类模型的准确率无本质差异。大多数类别在不同频段的准确率相似。
![[Frequency Distribution.png]]
### 低频特征与高频特征的重要性

随着高频信息的增加，模型准确率逐渐提高；缺少低频信息时，准确率急剧下降。标准训练模型更依赖低频成分，对低频损失的数据分布变化敏感。高频信息单独不足以使模型做出正确分类。

高频特征似乎与低频特征互补，以实现更好的泛化。然而，对抗攻击结果显示高频特征更易受对抗扰动影响，导致网络无法做出正确决策。
![[Importance of Frequencies.png]]
### 低频特征与高频特征的对比

一些类别仅依赖低频特征即可正确分类，其他类别需要低频和高频特征共同参与。实验发现，一些类别的准确率会随着高频特征的增加而逐渐下降，这可能是低频和高频特征之间的冲突导致的，最终是高频特征在分类结果中起决定性作用。

## 基于频率的攻击

为验证对抗攻击在不同频率上的有效性，对标准训练和重新训练的模型在不同频段进行了频率攻击。结果显示，仅用低频训练的模型在 $\mathcal F$-PGD 攻击下不如标准训练模型稳定。同样，仅用高频或特定频段训练的模型也不如标准训练模型鲁棒。$\mathcal F$-PGD 攻击表明，模型对训练中未出现的频段特征不鲁棒。进一步检查了不同频段特征在对抗攻击下的稳定性，低频特征在不同频段的攻击下表现出一定的稳定性，而高频特征在低频和高频攻击下都更受影响，且高频特征对最终分类结果的影响占主导地位。

### 低频特征的攻击

低频特征比高频特征更具稳定性，这解释了为什么一些模糊操作可以有效对抗攻击。许多类别可以仅靠超低频信息正确分类。然而，这些稳定的低频特征并不能提高网络的对抗鲁棒性。对依赖低频的样本在不同频段进行 $\mathcal F$-PGD-L 攻击，低频特征对各种频段的攻击具有一定鲁棒性，网络在仅使用低频特征时能做出正确决策。此外，低频频段的攻击会影响所有频段的特征，而高频频段的攻击几乎不干扰低频特征。对抗攻击对低频频段的影响高于高频频段。受干扰的高频特征主导网络做出最终错误决策。这表明稳定的低频特征不能提高鲁棒性，模型无法统一低频和高频特征。
![[F-PGD-L.png]]
## 结论

本文从傅里叶视角分析了特征提取和对抗鲁棒性。实验表明，低频和高频特征对决策都至关重要。低频特征是分类决策的基础，但当神经网络在不同频段特征上做出冲突决策时，高频特征通常占主导地位。攻击实验表明，低频特征对不同频段的攻击更具鲁棒性。然而，由于高频特征在决策中占主导地位且极易受到各种频段攻击的干扰，因此稳健的低频特征并不能提高 CNN 的对抗鲁棒性。未来的研究将探索减少网络对高频特征的敏感性以及提高更广泛频段特征的使用是否会提高网络的鲁棒性。